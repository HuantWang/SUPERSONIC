(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(e,t,a){e.exports=a(115)},115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(16),l=a.n(o),c=(a(107),a(7)),i=a(8),s=a(9),u=a(10),m=a(162),p=a(20),d=a(90),f=a(42),b=a(11),h=a.n(b),g=a(18),v=a(17),y=a(168),E=a(93),O=a(164),j=a(161),k=a(4),x=window.location.origin,C=function(){var e=Object(v.a)(h.a.mark((function e(t,a){var n,r,o,l,c,i,s,u,m,p;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new URL(t,x),r=0,o=Object.entries(a);r<o.length;r++)l=Object(g.a)(o[r],2),c=l[0],i=l[1],n.searchParams.set(c,i);return e.next=4,fetch(n.toString());case 4:return s=e.sent,e.next=7,s.json();case 7:if(u=e.sent,m=u.result,null===(p=u.error)){e.next=11;break}throw Error(p);case 11:return e.abrupt("return",m);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),N=function(){var e=Object(v.a)(h.a.mark((function e(t,a){var n,r,o,l,c,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},r=new URL(t,x),e.next=4,fetch(r.toString(),n);case 4:return o=e.sent,e.next=7,o.json();case 7:if(l=e.sent,c=l.result,null===(i=l.error)){e.next=11;break}throw Error(i);case 11:return e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),S=function(){return C("/api/ray_config",{})},w=function(){return C("/api/node_info",{})},T=function(){return C("/api/raylet_info",{})},_=function(e,t){return C("/api/errors",{hostname:e,pid:null===t?"":t})},I=function(e,t){return C("/api/logs",{hostname:e,pid:null===t?"":t})},F=function(e,t,a){return C("/api/launch_profiling",{node_id:e,pid:t,duration:a})},A=function(e){return C("/api/check_profiling_status",{profiling_id:e})},L=function(e){return"".concat(x,"/speedscope/index.html#profileURL=").concat(encodeURIComponent("".concat(x,"/api/get_profiling_info?profiling_id=").concat(e)))},M=function(e,t,a){return C("/api/kill_actor",{actor_id:e,ip_address:t,port:a})},D=function(){return C("/api/tune_info",{})},R=function(){return C("/api/tune_availability",{})},W=function(e){return N("/api/set_tune_experiment",{experiment:e})},P=function(){return N("/api/enable_tune_tensorboard",{})},B=function(e){return e?C("/api/memory_table",{}):null},z=function(){return C("/api/stop_memory_table",{})},U=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.lastUpdatedAt,n=e.error;return r.a.createElement("div",{className:t.root},null!==a&&r.a.createElement(E.a,{className:t.lastUpdated},"Last updated: ",new Date(a).toLocaleString()),null!==n&&r.a.createElement(E.a,{className:t.error},n))}}]),a}(r.a.Component),H=Object(p.b)((function(e){return{lastUpdatedAt:e.dashboard.lastUpdatedAt,error:e.dashboard.error}}))(Object(k.a)((function(e){return Object(y.a)({root:{marginTop:e.spacing(2)},lastUpdated:{color:e.palette.text.secondary,fontSize:"0.8125rem",textAlign:"center"},error:{color:e.palette.error.main,fontSize:"0.8125rem",textAlign:"center"}})}))(U)),G=a(55),V=a(71),J=a(146),q=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={expanded:!0,profiling:{}},e.setExpanded=function(t){return function(){e.setState({expanded:t})}},e.handleProfilingClick=function(t){return Object(v.a)(h.a.mark((function a(){var n,r,o;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(-1===(n=e.props.actor).state){a.next=9;break}return a.next=4,F(n.nodeId,n.pid,t);case 4:return r=a.sent,e.setState((function(e){return{profiling:Object(V.a)({},e.profiling,Object(G.a)({},r,{startTime:Date.now(),latestResponse:null}))}})),o=function(){var t=Object(v.a)(h.a.mark((function t(){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A(r);case 2:a=t.sent,e.setState((function(e){return{profiling:Object(V.a)({},e.profiling,Object(G.a)({},r,Object(V.a)({},e.profiling[r],{latestResponse:a})))}})),"pending"===a.status&&setTimeout(o,1e3);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a.next=9,o();case 9:case"end":return a.stop()}}),a)})))},e.killActor=function(){var t=e.props.actor;0===t.state&&M(t.actorId,t.ipAddress,t.port)},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.actor,o=this.state,l=o.expanded,c=o.profiling,i=-1!==n.state?[{label:"ActorTitle",value:n.actorTitle},{label:"State",value:n.state.toLocaleString()},{label:"Resources",value:Object.entries(n.usedResources).length>0&&Object.entries(n.usedResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(g.a)(e,2),a=t[0],n=t[1];return"".concat(n.toLocaleString()," ").concat(a)})).join(", ")},{label:"Pending",value:n.taskQueueLength.toLocaleString()},{label:"Executed",value:n.numExecutedTasks.toLocaleString()},{label:"NumObjectIdsInScope",value:n.numObjectIdsInScope.toLocaleString()},{label:"NumLocalObjects",value:n.numLocalObjects.toLocaleString()},{label:"UsedLocalObjectMemory",value:n.usedObjectStoreMemory.toLocaleString()}]:[{label:"ID",value:n.actorId},{label:"Required resources",value:Object.entries(n.requiredResources).length>0&&Object.entries(n.requiredResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(g.a)(e,2),a=t[0],n=t[1];return"".concat(n.toLocaleString()," ").concat(a)})).join(", ")}],s=[];return-1!==n.state&&n.webuiDisplay&&(s=Object.keys(n.webuiDisplay).sort().map((function(e,t,o){var l=n.webuiDisplay[e],c=JSON.parse(l),i=c.message;return"html"===c.dtype&&(i=r.a.createElement("div",{className:a.inlineHTML,dangerouslySetInnerHTML:{__html:i}})),""===e?r.a.createElement(E.a,{className:a.webuiDisplay},"\xa0 \xa0 ",i):r.a.createElement(E.a,{className:a.webuiDisplay},"\xa0 \xa0 ",e,": ",i)}))),r.a.createElement("div",{className:a.root},r.a.createElement(E.a,{className:a.title},-1!==n.state?r.a.createElement(r.a.Fragment,null,"Actor ",n.actorId," ",Object.entries(n.children).length>0&&r.a.createElement(r.a.Fragment,null,"(",r.a.createElement("span",{className:a.action,onClick:this.setExpanded(!l)},l?"Collapse":"Expand"),")")," ","(Profile for",[10,30,60].map((function(t){return r.a.createElement(r.a.Fragment,null," ",r.a.createElement("span",{className:a.action,onClick:e.handleProfilingClick(t)},t,"s"))})),")"," ",0===n.state&&r.a.createElement("span",{className:a.action,onClick:this.killActor},"Kill Actor"),Object.entries(c).map((function(e){var t=Object(g.a)(e,2),n=t[0],o=t[1],l=o.startTime,c=o.latestResponse;return null!==c&&r.a.createElement(r.a.Fragment,null,"(","pending"===c.status?"Profiling for ".concat(Math.round((Date.now()-l)/1e3),"s..."):"finished"===c.status?r.a.createElement("a",{className:a.action,href:L(n),rel:"noopener noreferrer",target:"_blank"},"Profiling result"):"error"===c.status?"Profiling error: ".concat(c.error.trim()):void 0,")"," ")}))):"infeasibleActor"===n.invalidStateType?r.a.createElement("span",{className:a.invalidStateTypeInfeasible},n.actorTitle," is infeasible. (This actor cannot be created because the Ray cluster cannot satisfy its resource requirements.)"):r.a.createElement("span",{className:a.invalidStateTypePendingActor},n.actorTitle," is pending until resources are available.")),r.a.createElement(E.a,{className:a.information},i.map((function(e){var t=e.label,n=e.value;return n&&n.length>0&&r.a.createElement(r.a.Fragment,{key:t},r.a.createElement("span",{className:a.datum},t,": ",n)," ")}))),-1!==n.state&&r.a.createElement(r.a.Fragment,null,s.length>0&&r.a.createElement(r.a.Fragment,null,s),r.a.createElement(J.a,{in:l},r.a.createElement(X,{actors:n.children}))))}}]),a}(r.a.Component),K=Object(k.a)((function(e){return Object(y.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,marginTop:e.spacing(2),padding:e.spacing(2)},title:{color:e.palette.text.secondary,fontSize:"0.75rem"},action:{color:e.palette.primary.main,textDecoration:"none","&:hover":{cursor:"pointer"}},invalidStateTypeInfeasible:{color:e.palette.error.main},invalidStateTypePendingActor:{color:e.palette.secondary.main},information:{fontSize:"0.875rem"},datum:{"&:not(:first-child)":{marginLeft:e.spacing(2)}},webuiDisplay:{fontSize:"0.875rem"},inlineHTML:{fontSize:"0.875rem",display:"inline"}})}))(q),Y=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.actors;return Object.entries(e).map((function(e){var t=Object(g.a)(e,2),a=t[0],n=t[1];return r.a.createElement(K,{actor:n,key:a})}))}}]),a}(r.a.Component),X=Object(k.a)((function(e){return Object(y.a)({})}))(Y),Q=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.rayletInfo;return r.a.createElement("div",null,null===e?r.a.createElement(E.a,{color:"textSecondary"},"Loading..."):0===Object.entries(e.actors).length?r.a.createElement(E.a,{color:"textSecondary"},"No actors found."):r.a.createElement(X,{actors:e.actors}))}}]),a}(r.a.Component),$=Object(p.b)((function(e){return{rayletInfo:e.dashboard.rayletInfo}}))(Object(k.a)((function(e){return Object(y.a)({warning:{fontSize:"0.8125rem",marginBottom:e.spacing(2)},warningIcon:{fontSize:"1.25em",verticalAlign:"text-bottom"}})}))(Q)),Z=a(149),ee=a(150),te=a(151),ae=a(147),ne=a(148),re=a(152),oe=a(86),le=a.n(oe),ce=a(87),ie=a.n(ce),se=a(69),ue=Object(se.b)({name:"dashboard",initialState:{tab:0,rayConfig:null,nodeInfo:null,rayletInfo:null,tuneInfo:null,tuneAvailability:null,lastUpdatedAt:null,error:null,memoryTable:null,shouldObtainMemoryTable:!1},reducers:{setTab:function(e,t){e.tab=t.payload},setRayConfig:function(e,t){e.rayConfig=t.payload},setNodeAndRayletInfo:function(e,t){e.nodeInfo=t.payload.nodeInfo,e.rayletInfo=t.payload.rayletInfo,e.lastUpdatedAt=Date.now()},setTuneInfo:function(e,t){e.tuneInfo=t.payload,e.lastUpdatedAt=Date.now()},setTuneAvailability:function(e,t){e.tuneAvailability=t.payload,e.lastUpdatedAt=Date.now()},setError:function(e,t){e.error=t.payload},setMemoryTable:function(e,t){e.memoryTable=t.payload},setShouldObtainMemoryTable:function(e,t){e.shouldObtainMemoryTable=t.payload}}}),me=ue.actions,pe=ue.reducer,de=a(62),fe=a.n(de),be=a(64),he=a.n(be),ge=a(36),ve=a.n(ge),ye=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={expanded:e.props.initialExpanded},e.toggleExpand=function(){e.setState((function(e){return{expanded:!e.expanded}}))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.memoryTableSummary,n=null!==a?["","Total Local Reference Count: ".concat(a.total_local_ref_count),"Total Pinned In Memory Count: ".concat(a.total_pinned_in_memory),"Total Used By Pending Tasks Count: ".concat(a.total_used_by_pending_task),"Total Caputed In Objects Count: ".concat(a.total_captured_in_objects),"Total Object Size: ".concat(a.total_object_size," B"),"Total Actor Handle Count: ".concat(a.total_actor_handles),""]:["No Summary Provided"];return null!==a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{hover:!0},n.map((function(e,a){return r.a.createElement(ne.a,{key:a,className:t.cell},e)}))))}}]),a}(r.a.Component),Ee=Object(k.a)((function(e){return Object(y.a)({cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},extraInfo:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",whiteSpace:"pre"}})}))(ye),Oe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={expanded:e.props.initialExpanded},e.toggleExpand=function(){e.setState((function(e){return{expanded:!e.expanded}}))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.groupKey,n=e.memoryTableGroups,o=this.state.expanded,l=n[a],c=l.entries,i=l.summary;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{hover:!0},r.a.createElement(ne.a,{className:ve()(t.cell,t.expandCollapseCell),onClick:this.toggleExpand},o?r.a.createElement(he.a,{className:t.expandCollapseIcon}):r.a.createElement(fe.a,{className:t.expandCollapseIcon})),["node_ip_address","pid","type","object_id","object_size","reference_type","call_site"].map((function(e,n){return r.a.createElement(ne.a,{className:t.cell,key:n},"node_ip_address"===e?a:"")}))),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{initialExpanded:!1,memoryTableSummary:i}),c.map((function(e,a){var n=-1===e.object_size?"?":"".concat(e.object_size,"  B"),o=["",e.node_ip_address,e.pid,e.type,e.object_id,n,e.reference_type,e.call_site];return r.a.createElement(ae.a,{hover:!0,key:a},o.map((function(e,a){return r.a.createElement(ne.a,{key:a,className:t.cell},e)})))}))))}}]),a}(r.a.Component),je=Object(k.a)((function(e){return Object(y.a)({cell:{padding:e.spacing(1),textAlign:"center"},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},extraInfo:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",whiteSpace:"pre"}})}))(Oe),ke=me,xe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handlePauseMemoryTable=Object(v.a)(h.a.mark((function t(){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props.shouldObtainMemoryTable,e.props.setShouldObtainMemoryTable(!a),!a){t.next=5;break}return t.next=5,z();case 5:case"end":return t.stop()}}),t)}))),e.renderIcon=function(){return e.props.shouldObtainMemoryTable?r.a.createElement(le.a,null):r.a.createElement(ie.a,null)},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.memoryTable;return r.a.createElement(r.a.Fragment,null,null!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.a,{color:"primary",onClick:this.handlePauseMemoryTable},this.renderIcon(),this.props.shouldObtainMemoryTable?"Pause Collection":"Resume Collection"),r.a.createElement(ee.a,{className:t.table},r.a.createElement(te.a,null,r.a.createElement(ae.a,null,["","IP Address","Pid","Type","Object ID","Object Size","Reference Type","Call Site"].map((function(e,a){return r.a.createElement(ne.a,{key:a,className:t.cell},e)})))),r.a.createElement(re.a,null,Object.keys(a.group).map((function(e,t){return r.a.createElement(je,{key:t,groupKey:e,memoryTableGroups:a.group,initialExpanded:!0})}))))):r.a.createElement("div",null,"No Memory Table Information Provided"))}}]),a}(r.a.Component),Ce=Object(p.b)((function(e){return{tab:e.dashboard.tab,memoryTable:e.dashboard.memoryTable,shouldObtainMemoryTable:e.dashboard.shouldObtainMemoryTable}}),ke)(Object(k.a)((function(e){return Object(y.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center"}})}))(xe)),Ne=a(22),Se=function(e){if(0===e.length)return 0;var t,a=0,n=0,r=Object(Ne.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,l=o.weight;a+=l*o.value,n+=l}}catch(c){r.e(c)}finally{r.f()}return a/n},we=function(e){return e.reduce((function(e,t){return e+t}),0)},Te=a(15),_e=a(167),Ie=a(154),Fe=a(88),Ae=a.n(Fe),Le=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleClose,n=e.title;return r.a.createElement(_e.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:a,open:!0,scroll:"body"},r.a.createElement(Ie.a,{className:t.closeButton,onClick:a},r.a.createElement(Ae.a,null)),r.a.createElement(E.a,{className:t.title},n),this.props.children)}}]),a}(r.a.Component),Me=Object(k.a)((function(e){return Object(y.a)({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1.5),top:e.spacing(1.5),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,fontSize:"1.5rem",lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3)}})}))(Le),De=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.lines;return r.a.createElement(ee.a,null,r.a.createElement(re.a,null,a.map((function(e,a){return r.a.createElement(ae.a,{key:a},r.a.createElement(ne.a,{className:ve()(t.cell,t.lineNumber),"data-line-number":a+1}),r.a.createElement(ne.a,{className:ve()(t.cell,t.line)},e))}))))}}]),a}(r.a.Component),Re=Object(k.a)((function(e){return Object(y.a)({root:{overflowX:"auto"},cell:{borderWidth:0,fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",padding:0,"&:last-child":{paddingRight:0}},lineNumber:{color:e.palette.text.secondary,paddingRight:e.spacing(2),textAlign:"right",verticalAlign:"top",width:"1%","&::before":{content:"attr(data-line-number)"}},line:{textAlign:"left",whiteSpace:"pre-wrap"}})}))(De),We=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(h.a.mark((function e(){var t,a,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,a=t.hostname,n=t.pid,e.next=4,_(a,n);case 4:r=e.sent,this.setState({result:r,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.clearErrorDialog,n=e.hostname,o=this.state,l=o.result,c=o.error;return r.a.createElement(Me,{handleClose:a,title:"Errors"},null!==c?r.a.createElement(E.a,{color:"error"},c):null===l?r.a.createElement(E.a,{color:"textSecondary"},"Loading..."):Object.entries(l).map((function(e){var a=Object(g.a)(e,2),o=a[0],l=a[1];return r.a.createElement(r.a.Fragment,{key:o},r.a.createElement(E.a,{className:t.header},n," (PID: ",o,")"),l.length>0?l.map((function(e,a){var n=e.message,o=e.timestamp;return r.a.createElement("div",{className:t.error,key:a},r.a.createElement(E.a,{className:t.timestamp},"Error at ",new Date(1e3*o).toLocaleString()),r.a.createElement(Re,{lines:n.trim().split("\n")}))})):r.a.createElement(E.a,{color:"textSecondary"},"No errors found."))})))}}]),a}(r.a.Component),Pe=Object(k.a)((function(e){return Object(y.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},error:{backgroundColor:Object(Te.b)(e.palette.error.main,.04),borderLeftColor:e.palette.error.main,borderLeftStyle:"solid",borderLeftWidth:2,marginTop:e.spacing(3),padding:e.spacing(2)},timestamp:{color:e.palette.text.secondary,marginBottom:e.spacing(1)}})}))(We),Be=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(h.a.mark((function e(){var t,a,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,a=t.hostname,n=t.pid,e.next=4,I(a,n);case 4:r=e.sent,this.setState({result:r,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.clearLogDialog,n=e.hostname,o=this.state,l=o.result,c=o.error;return r.a.createElement(Me,{handleClose:a,title:"Logs"},null!==c?r.a.createElement(E.a,{color:"error"},c):null===l?r.a.createElement(E.a,{color:"textSecondary"},"Loading..."):Object.entries(l).map((function(e){var a=Object(g.a)(e,2),o=a[0],l=a[1];return r.a.createElement(r.a.Fragment,{key:o},r.a.createElement(E.a,{className:t.header},n," (PID: ",o,")"),l.length>0?r.a.createElement("div",{className:t.log},r.a.createElement(Re,{lines:l})):r.a.createElement(E.a,{color:"textSecondary"},"No logs found."))})))}}]),a}(r.a.Component),ze=Object(k.a)((function(e){return Object(y.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},log:{backgroundColor:Object(Te.b)(e.palette.primary.main,.04),borderLeftColor:e.palette.primary.main,borderLeftStyle:"solid",borderLeftWidth:2,padding:e.spacing(2)}})}))(Be),Ue=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.text,n=this.props.percent;n=Math.max(n,0);var o=[0,255,0],l=o,c=function(e,t,a){var n=Object(g.a)(e,3),r=n[0],o=n[1],l=n[2],c=Object(g.a)(t,3);return[r*(1-a)+c[0]*a,o*(1-a)+c[1]*a,l*(1-a)+c[2]*a]}(o,[255,0,0],(n=Math.min(n,100))/100),i="\n      linear-gradient(\n        to right,\n        rgba(".concat(l.join(","),", ").concat(.2,") 0%,\n        rgba(").concat(c.join(","),", ").concat(.2,") ").concat(n,"%,\n        transparent ").concat(n,"%\n      )\n    ");return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.inner,style:{background:i}},a))}}]),a}(r.a.Component),He=Object(k.a)((function(e){return Object(y.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1},inner:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}})}))(Ue),Ge=function(e){var t=e.nodes,a=Se(t.map((function(e){return{weight:e.cpus[0],value:e.cpu}})));return r.a.createElement("div",{style:{minWidth:60}},r.a.createElement(He,{percent:a,text:"".concat(a.toFixed(1),"%")}))},Ve=function(e){var t=e.node;return r.a.createElement("div",{style:{minWidth:60}},r.a.createElement(He,{percent:t.cpu,text:"".concat(t.cpu.toFixed(1),"%")}))},Je=function(e){var t=e.worker;return r.a.createElement("div",{style:{minWidth:60}},r.a.createElement(He,{percent:t.cpu_percent,text:"".concat(t.cpu_percent.toFixed(1),"%")}))},qe=function(e,t){return"".concat((e/("mebibyte"===t?Math.pow(1024,2):Math.pow(1024,3))).toFixed(1)," ").concat("mebibyte"===t?"MiB":"GiB")},Ke=function(e,t,a){var n=qe(e,a),r=qe(t,a),o=100*e/t;return"".concat(n," / ").concat(r," (").concat(o.toFixed(0),"%)")},Ye=function(e){var t=Math.floor(e)%60,a=Math.floor(e/60)%60,n=Math.floor(e/60/60)%24,r=Math.floor(e/60/60/24),o=function(e){return e.toString().padStart(2,"0")};return[r?"".concat(r,"d"):"","".concat(o(n),"h"),"".concat(o(a),"m"),"".concat(o(t),"s")].join(" ")},Xe=function(e){try{return(e.toString().split(".")[1].length||0)<=3?e.toString():Math.abs(e.valueOf())>=1?e.toPrecision(5):e.toExponential()}catch(t){return e.toString()}},Qe=function(e){var t,a=e.nodes,n=0,o=0,l=Object(Ne.a)(a);try{for(l.s();!(t=l.n()).done;){var c=t.value;n+=c.disk["/"].used,o+=c.disk["/"].total}}catch(i){l.e(i)}finally{l.f()}return r.a.createElement(He,{percent:100*n/o,text:Ke(n,o,"gibibyte")})},$e=function(e){var t=e.node;return r.a.createElement(He,{percent:100*t.disk["/"].used/t.disk["/"].total,text:Ke(t.disk["/"].used,t.disk["/"].total,"gibibyte")})},Ze=function(){return r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},et=a(92),tt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=Object(et.a)(e,["classes"]);return r.a.createElement("span",Object.assign({className:t.button},a))}}]),a}(r.a.Component),at=Object(k.a)((function(e){return Object(y.a)({button:{color:e.palette.primary.main,"&:hover":{cursor:"pointer",textDecoration:"underline"}}})}))(tt),nt=function(e){return function(t){var a,n=t.nodes,o=0,l=Object(Ne.a)(n);try{for(l.s();!(a=l.n()).done;){var c=a.value;c.ip in e&&(o+=e[c.ip].total)}}catch(i){l.e(i)}finally{l.f()}return 0===o?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):r.a.createElement(r.a.Fragment,null,o.toLocaleString()," ",1===o?"error":"errors")}},rt=function(e,t){return function(a){var n=a.node;return 0===e.total?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):r.a.createElement(at,{onClick:function(){return t(n.hostname,null)}},"View all errors (",e.total.toLocaleString(),")")}},ot=function(e,t){return function(a){var n=a.node,o=a.worker;return e.perWorker[o.pid]?r.a.createElement(at,{onClick:function(){return t(n.hostname,o.pid)}},"View errors (",e.perWorker[o.pid].toLocaleString(),")"):r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors")}},lt=function(e){return e.gpus&&0!==e.gpus.length?we(e.gpus.map((function(e){return e.utilization_gpu})))/e.gpus.length:NaN},ct=function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:lt(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:Se(t)}(e.nodes);return r.a.createElement("div",{style:{minWidth:60}},isNaN(t)?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.a.createElement(He,{percent:t,text:"".concat(t.toFixed(1),"%")}))},it=function(e){var t=e.node,a=lt(t);return r.a.createElement("div",{style:{minWidth:60}},isNaN(a)?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.a.createElement(He,{percent:a,text:"".concat(a.toFixed(1),"%")}))},st=function(e){var t=e.rayletWorker,a=null===t||void 0===t?void 0:t.coreWorkerStats.usedResources,n=(null===a||void 0===a?void 0:a.GPU)||NaN,o=isNaN(n)?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.a.createElement("b",null,"`$",n," GPUs in use`");return r.a.createElement("div",{style:{minWidth:60}},o)},ut=function(e){return 0===e.gpus.length?NaN:100*(we(e.gpus.map((function(e){return function(e){return e.memory_used/e.memory_total}(e)})))/e.gpus.length)},mt=function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:ut(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:Se(t)}(e.nodes);return r.a.createElement("div",{style:{minWidth:60}},isNaN(t)?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.a.createElement(He,{percent:t,text:"".concat(t.toFixed(1),"%")}))},pt=function(e){var t=e.node,a=ut(t);return r.a.createElement("div",{style:{minWidth:60}},isNaN(a)?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.a.createElement(He,{percent:a,text:"".concat(a.toFixed(1),"%")}))},dt=function(e){var t,a,n=e.worker,o=e.node,l=o.gpus.map((function(e){return e.processes})).map((function(e){return e.find((function(e){return e.pid===n.pid}))})).map((function(e){return(null===e||void 0===e?void 0:e.gpu_memory_usage)||0})),c=we(o.gpus.map((function(e){return e.memory_total}))),i=we(l);return r.a.createElement("div",{style:{minWidth:60}},0===o.gpus.length?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):r.a.createElement(He,{percent:i/c*100,text:(t=i,a=c,"".concat(t," MiB / ").concat(a," MiB (").concat((t/a*100).toFixed(1),"%)"))}))},ft=function(e){var t=e.nodes;return r.a.createElement(r.a.Fragment,null,"Totals (",t.length.toLocaleString()," ",1===t.length?"host":"hosts",")")},bt=function(e){var t=e.node;return r.a.createElement(r.a.Fragment,null,t.hostname," (",t.ip,")")},ht=function(e){var t=e.worker;return r.a.createElement(r.a.Fragment,null,t.cmdline[0].split("::",2)[0]," (PID: ",t.pid,")")},gt=function(e){return function(t){var a,n=t.nodes,o=0,l=Object(Ne.a)(n);try{for(l.s();!(a=l.n()).done;){var c=a.value;c.ip in e&&(o+=e[c.ip].total)}}catch(i){l.e(i)}finally{l.f()}return 0===o?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):r.a.createElement(r.a.Fragment,null,o.toLocaleString()," ",1===o?"line":"lines")}},vt=function(e,t){return function(a){var n=a.node;return 0===e.total?r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):r.a.createElement(at,{onClick:function(){return t(n.hostname,null)}},"View all logs (",e.total.toLocaleString()," ",1===e.total?"line":"lines",")")}},yt=function(e,t){return function(a){var n=a.node,o=a.worker;return e.perWorker[o.pid]?r.a.createElement(at,{onClick:function(){return t(n.hostname,o.pid)}},"View log (",e.perWorker[o.pid].toLocaleString()," ",1===e.perWorker[o.pid]?"line":"lines",")"):r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs")}},Et=function(e){var t,a=e.nodes,n=0,o=0,l=Object(Ne.a)(a);try{for(l.s();!(t=l.n()).done;){var c=t.value;n+=c.mem[0]-c.mem[1],o+=c.mem[0]}}catch(i){l.e(i)}finally{l.f()}return r.a.createElement(He,{percent:100*n/o,text:Ke(n,o,"gibibyte")})},Ot=function(e){var t=e.node;return r.a.createElement(He,{percent:100*(t.mem[0]-t.mem[1])/t.mem[0],text:Ke(t.mem[0]-t.mem[1],t.mem[0],"gibibyte")})},jt=function(e){var t=e.node,a=e.worker;return r.a.createElement(He,{percent:100*a.memory_info.rss/t.mem[0],text:qe(a.memory_info.rss,"mebibyte")})},kt=function(e){var t,a=e.nodes,n=0,o=Object(Ne.a)(a);try{for(o.s();!(t=o.n()).done;){n+=t.value.net[1]}}catch(l){o.e(l)}finally{o.f()}return r.a.createElement(r.a.Fragment,null,qe(n,"mebibyte"),"/s")},xt=function(e){var t=e.node;return r.a.createElement(r.a.Fragment,null,qe(t.net[1],"mebibyte"),"/s")},Ct=function(){return r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},Nt=function(e){var t,a=e.nodes,n=0,o=Object(Ne.a)(a);try{for(o.s();!(t=o.n()).done;){n+=t.value.net[0]}}catch(l){o.e(l)}finally{o.f()}return r.a.createElement(r.a.Fragment,null,qe(n,"mebibyte"),"/s")},St=function(e){var t=e.node;return r.a.createElement(r.a.Fragment,null,qe(t.net[0],"mebibyte"),"/s")},wt=function(){return r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},Tt=function(e){return Date.now()/1e3-e},_t=function(e){e.nodes;return r.a.createElement(E.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},It=function(e){var t=e.node;return r.a.createElement(r.a.Fragment,null,Ye(Tt(t.boot_time)))},Ft=function(e){var t=e.worker;return r.a.createElement(r.a.Fragment,null,Ye(Tt(t.create_time)))},At=function(e){var t=e.worker;return r.a.createElement(r.a.Fragment,null,t.cmdline[0].split("::",2)[1])},Lt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={expanded:e.props.initialExpanded},e.toggleExpand=function(){e.setState((function(e){return{expanded:!e.expanded}}))},e}return Object(i.a)(a,[{key:"render",value:function(){var e,t=this.props,a=t.classes,n=t.node,o=t.raylet,l=t.clusterWorkers,c=t.logCounts,i=t.errorCounts,s=t.setLogDialog,u=t.setErrorDialog,m=this.state.expanded,p=[{NodeFeature:bt,WorkerFeature:ht},{NodeFeature:(e=l.length,function(t){var a=t.node.cpus[0];return r.a.createElement(r.a.Fragment,null,e.toLocaleString()," ",1===e?"worker":"workers"," / ",a.toLocaleString()," ",1===a?"core":"cores")}),WorkerFeature:At},{NodeFeature:It,WorkerFeature:Ft},{NodeFeature:Ve,WorkerFeature:Je},{NodeFeature:Ot,WorkerFeature:jt},{NodeFeature:it,WorkerFeature:st},{NodeFeature:pt,WorkerFeature:dt},{NodeFeature:$e,WorkerFeature:Ze},{NodeFeature:St,WorkerFeature:wt},{NodeFeature:xt,WorkerFeature:Ct},{NodeFeature:vt(c,s),WorkerFeature:yt(c,s)},{NodeFeature:rt(i,u),WorkerFeature:ot(i,u)}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{hover:!0},r.a.createElement(ne.a,{className:ve()(a.cell,a.expandCollapseCell),onClick:this.toggleExpand},m?r.a.createElement(he.a,{className:a.expandCollapseIcon}):r.a.createElement(fe.a,{className:a.expandCollapseIcon})),p.map((function(e,t){var o=e.NodeFeature;return r.a.createElement(ne.a,{className:a.cell,key:t},r.a.createElement(o,{node:n}))}))),m&&r.a.createElement(r.a.Fragment,null,null!==o&&void 0!==o.extraInfo&&r.a.createElement(ae.a,{hover:!0},r.a.createElement(ne.a,{className:a.cell}),r.a.createElement(ne.a,{className:ve()(a.cell,a.extraInfo),colSpan:p.length},o.extraInfo)),l.map((function(e,t){var l=(null===o||void 0===o?void 0:o.workersStats.find((function(t){return e.pid===t.pid})))||null;return r.a.createElement(ae.a,{hover:!0,key:t},r.a.createElement(ne.a,{className:a.cell}),p.map((function(t,o){var c=t.WorkerFeature;return r.a.createElement(ne.a,{className:a.cell,key:o},r.a.createElement(c,{node:n,worker:e,rayletWorker:l}))})))}))))}}]),a}(r.a.Component),Mt=Object(k.a)((function(e){return Object(y.a)({cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},extraInfo:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",whiteSpace:"pre"}})}))(Lt),Dt=a(89),Rt=a.n(Dt),Wt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e,t=this.props,a=t.classes,n=t.nodes,o=t.clusterTotalWorkers,l=t.logCounts,c=t.errorCounts,i=[{ClusterFeature:ft},{ClusterFeature:(e=o,function(t){var a,n=t.nodes,o=0,l=Object(Ne.a)(n);try{for(l.s();!(a=l.n()).done;)o+=a.value.cpus[0]}catch(c){l.e(c)}finally{l.f()}return r.a.createElement(r.a.Fragment,null,e.toLocaleString()," ",1===e?"worker":"workers"," / ",o.toLocaleString()," ",1===o?"core":"cores")})},{ClusterFeature:_t},{ClusterFeature:Ge},{ClusterFeature:Et},{ClusterFeature:ct},{ClusterFeature:mt},{ClusterFeature:Qe},{ClusterFeature:Nt},{ClusterFeature:kt},{ClusterFeature:gt(l)},{ClusterFeature:nt(c)}];return r.a.createElement(ae.a,{hover:!0},r.a.createElement(ne.a,{className:a.cell},r.a.createElement(Rt.a,{className:a.totalIcon})),i.map((function(e,t){var o=e.ClusterFeature;return r.a.createElement(ne.a,{className:a.cell,key:t},r.a.createElement(o,{nodes:n}))})))}}]),a}(r.a.Component),Pt=Object(k.a)((function(e){return Object(y.a)({cell:{borderTopColor:e.palette.divider,borderTopStyle:"solid",borderTopWidth:2,padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},totalIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"}})}))(Wt),Bt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={logDialog:null,errorDialog:null},e.setLogDialog=function(t,a){e.setState({logDialog:{hostname:t,pid:a}})},e.clearLogDialog=function(){e.setState({logDialog:null})},e.setErrorDialog=function(t,a){e.setState({errorDialog:{hostname:t,pid:a}})},e.clearErrorDialog=function(){e.setState({errorDialog:null})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.nodeInfo,o=t.rayletInfo,l=this.state,c=l.logDialog,i=l.errorDialog;if(null===n||null===o)return r.a.createElement(E.a,{color:"textSecondary"},"Loading...");var s,u={},m={},p=function(e){for(var t=new Map,a=new Set,n=0,r=Object.entries(e.nodes);n<r.length;n++){var o,l=Object(g.a)(r[n],2),c=l[0],i=l[1].workersStats,s=Object(Ne.a)(i);try{for(s.s();!(o=s.n()).done;){var u=o.value;u.isDriver||a.add(u.pid.toString())}}catch(m){s.e(m)}finally{s.f()}t.set(c,a)}return t}(o),d=we(Array.from(p.values()).map((function(e){return e.size}))),f=Object(Ne.a)(n.clients);try{var b=function(){var e=s.value,t=p.get(e.ip);if(!t)return"continue";var a=Object.entries(n.log_counts[e.ip]||{}).filter((function(e){var a=Object(g.a)(e,2),n=a[0];a[1];return t.has(n)})),r=we(a.map((function(e){var t=Object(g.a)(e,2);t[0];return t[1]})));u[e.ip]={perWorker:Object.fromEntries(a),total:r};var o=Object.entries(n.error_counts[e.ip]||{}).filter((function(e){var a=Object(g.a)(e,2),n=a[0];a[1];return t.has(n)})),l=we(o.map((function(e){var t=Object(g.a)(e,2);t[0];return t[1]})));m[e.ip]={perWorker:Object.fromEntries(o),total:l}};for(f.s();!(s=f.n()).done;)b()}catch(h){f.e(h)}finally{f.f()}return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.a,{className:a.table},r.a.createElement(te.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,{className:a.cell}),r.a.createElement(ne.a,{className:a.cell},"Host"),r.a.createElement(ne.a,{className:a.cell},"Workers"),r.a.createElement(ne.a,{className:a.cell},"Uptime"),r.a.createElement(ne.a,{className:a.cell},"CPU"),r.a.createElement(ne.a,{className:a.cell},"RAM"),r.a.createElement(ne.a,{className:a.cell},"GPU"),r.a.createElement(ne.a,{className:a.cell},"GRAM"),r.a.createElement(ne.a,{className:a.cell},"Disk"),r.a.createElement(ne.a,{className:a.cell},"Sent"),r.a.createElement(ne.a,{className:a.cell},"Received"),r.a.createElement(ne.a,{className:a.cell},"Logs"),r.a.createElement(ne.a,{className:a.cell},"Errors"))),r.a.createElement(re.a,null,n.clients.map((function(t){var a=p.get(t.ip)||new Set;return r.a.createElement(Mt,{key:t.ip,clusterWorkers:t.workers.filter((function(e){return a.has(e.pid.toString())})).sort((function(e,t){return"ray::IDLE"===t.cmdline[0]?-1:"ray::IDLE"===e.cmdline[0]?1:e.pid<t.pid?-1:1})),node:t,raylet:t.ip in o.nodes?o.nodes[t.ip]:null,logCounts:u[t.ip],errorCounts:m[t.ip],setLogDialog:e.setLogDialog,setErrorDialog:e.setErrorDialog,initialExpanded:n.clients.length<=1})})),r.a.createElement(Pt,{clusterTotalWorkers:d,nodes:n.clients,logCounts:u,errorCounts:m}))),null!==c&&r.a.createElement(ze,{clearLogDialog:this.clearLogDialog,hostname:c.hostname,pid:c.pid}),null!==i&&r.a.createElement(Pe,{clearErrorDialog:this.clearErrorDialog,hostname:i.hostname,pid:i.pid}))}}]),a}(r.a.Component),zt=Object(p.b)((function(e){return{nodeInfo:e.dashboard.nodeInfo,rayletInfo:e.dashboard.rayletInfo}}))(Object(k.a)((function(e){return Object(y.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})}))(Bt)),Ut=me,Ht=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).refreshRayConfig=Object(v.a)(h.a.mark((function t(){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S();case 3:a=t.sent,e.props.setRayConfig(a),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:return t.prev=9,setTimeout(e.refreshRayConfig,1e4),t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[0,7,9,12]])}))),e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshRayConfig();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.rayConfig;if(null===a)return r.a.createElement(E.a,{color:"textSecondary"},"No Ray configuration detected.");var n=[{key:"Autoscaling mode",value:a.autoscaling_mode},{key:"Head node type",value:a.head_type},{key:"Worker node type",value:a.worker_type},{key:"Min worker nodes",value:a.min_workers},{key:"Initial worker nodes",value:a.initial_workers},{key:"Max worker nodes",value:a.max_workers},{key:"Idle timeout",value:"".concat(a.idle_timeout_minutes," ").concat(1===a.idle_timeout_minutes?"minute":"minutes")}];return r.a.createElement("div",null,r.a.createElement(E.a,null,"Ray cluster configuration:"),r.a.createElement(ee.a,{className:t.table},r.a.createElement(te.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,{className:t.cell},"Setting"),r.a.createElement(ne.a,{className:t.cell},"Value"))),r.a.createElement(re.a,null,n.map((function(e,a){var n=e.key,o=e.value;return r.a.createElement(ae.a,{key:a},r.a.createElement(ne.a,{className:ve()(t.cell,t.key)},n),r.a.createElement(ne.a,{className:t.cell},o))})))))}}]),a}(r.a.Component),Gt=Object(p.b)((function(e){return{rayConfig:e.dashboard.rayConfig}}),Ut)(Object(k.a)((function(e){return Object(y.a)({table:{marginTop:e.spacing(1),width:"auto"},cell:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3),paddingRight:e.spacing(3),textAlign:"center","&:last-child":{paddingRight:e.spacing(3)}},key:{color:e.palette.text.secondary}})}))(Ht)),Vt=a(163),Jt=a(160),qt=a(155),Kt=me,Yt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={currentError:"",open:!1},e.handleOpen=function(t){e.setState({open:!0,currentError:t})},e.handleClose=function(){e.setState({open:!1})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.tuneInfo,o=this.state,l=o.currentError,c=o.open;return null===n||0===Object.keys(n.errors).length?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.a,{className:a.table},r.a.createElement(te.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,{className:a.cell}," Job ID"),r.a.createElement(ne.a,{className:a.cell}," Trial ID "),r.a.createElement(ne.a,{className:a.cell}," Trial Directory "),r.a.createElement(ne.a,{className:a.cell}," Error "))),r.a.createElement(re.a,null,null!==n.errors&&Object.keys(n.errors).map((function(t,o){return r.a.createElement(ae.a,{key:o},r.a.createElement(ne.a,{className:a.cell},n.errors[t].job_id),r.a.createElement(ne.a,{className:a.cell},n.errors[t].trial_id),r.a.createElement(ne.a,{className:a.cell},t),r.a.createElement(ne.a,{className:a.cell},r.a.createElement(qt.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t)}},"Show Error")))})))),c&&r.a.createElement(Me,{handleClose:this.handleClose,title:"Error Log"},c&&r.a.createElement(Re,{lines:n.errors[l].text.trim().split("\n")})))}}]),a}(r.a.Component),Xt=Object(p.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),Kt)(Object(k.a)((function(e){return Object(y.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})}))(Yt)),Qt=a(169),$t=a(170),Zt=a(156),ea=a(157),ta=a(158),aa=a(166),na=a(159),ra=me,oa=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).timeout=0,e.state={sortedColumn:void 0,ascending:!0,metricParamColumn:"",metricColumns:[],paramColumns:[],errorTrial:"",open:!1},e.onColumnClick=function(t,a){var n=e.state.ascending;n=t!==e.state.sortedColumn||!n,e.setState({sortedColumn:t,ascending:n}),a&&e.setState({metricParamColumn:a})},e.humanize=function(e){return e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},e.handleOpen=function(t){"number"===typeof t&&(t=t.toString()),e.setState({open:!0,errorTrial:t})},e.handleClose=function(){e.setState({open:!1})},e.sortedCell=function(t,a,n){var o=e.props,l=o.tuneInfo,c=o.classes,i=e.state,s=i.sortedColumn,u=i.ascending,m=i.metricParamColumn,p="asc";if(t!==s||u||(p="desc"),null!==l){var d=function(){return e.onColumnClick(t)};a&&(d=function(){return e.onColumnClick(t,a)}),n||(n=0);var f=!1,b=t+n.toString();return a?(b=a+n.toString(),f=a===m&&s===t):f=t===s,r.a.createElement(ne.a,{className:c.cell,key:b,onClick:d},r.a.createElement(Qt.a,{active:f,direction:p}),a?e.humanize(a):e.humanize(t))}},e.sortedTrialRecords=function(){var t=e.props.tuneInfo,a=e.state,n=a.sortedColumn,r=a.ascending,o=a.metricParamColumn;if(null===t||0===Object.keys(t.trial_records).length)return null;var l=Object.values(t.trial_records);if(!n)return l;var c=function(e){return e[n]};return"metrics"!==n&&"params"!==n||(c=function(e){return e[n][o]}),n&&(r?l.sort((function(e,t){return c(e)>c(t)?1:-1})):r||l.sort((function(e,t){return c(e)<c(t)?1:-1}))),l},e.handleMetricChoiceChange=function(t){return function(a){var n=e.state.metricColumns;a.target.checked?(n.push(t),e.setState({metricColumns:n})):(n=n.filter((function(e){return e!==t})),e.setState({metricColumns:n}))}},e.metricChoices=function(t){var a=e.state.metricColumns;return r.a.createElement($t.a,null,r.a.createElement(Zt.a,{component:"legend"},"Select Metrics "),r.a.createElement(ea.a,null,t.map((function(t){return r.a.createElement(ta.a,{control:r.a.createElement(aa.a,{checked:a.includes(t),onChange:e.handleMetricChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e.handleParamChoiceChange=function(t){return function(a){var n=e.state.paramColumns;a.target.checked?(n.push(t),e.setState({paramColumns:n})):(n=n.filter((function(e){return e!==t})),e.setState({paramColumns:n}))}},e.paramChoices=function(t){var a=e.props.classes,n=e.state.paramColumns;return r.a.createElement($t.a,{className:a.paramChecklist},r.a.createElement(Zt.a,{component:"legend"},"Select Parameters "),r.a.createElement(ea.a,null,t.map((function(t){return r.a.createElement(ta.a,{control:r.a.createElement(aa.a,{checked:n.includes(t),onChange:e.handleParamChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.tuneInfo,o=this.state,l=o.metricColumns,c=o.paramColumns,i=o.open,s=o.errorTrial;if(null===n||0===Object.keys(n.trial_records).length)return null;var u=Object.keys(n.trial_records)[0],m=n.trial_records[u].params,p=Object.keys(m).filter((function(e){return"args"!==e})),d=p,f=p.length>3;f&&(0===c.length&&this.setState({paramColumns:p.slice(0,3)}),d=c);var b=Object.keys(n.trial_records[u].metrics),h=b,g=b.length>3;g&&(0===l.length&&this.setState({metricColumns:b.slice(0,3)}),h=l);var v=this.sortedTrialRecords();return r.a.createElement("div",{className:a.root},r.a.createElement(na.a,{container:!0,spacing:0},(f||g)&&r.a.createElement(na.a,{item:!0,xs:2,className:a.checkboxRoot},f&&this.paramChoices(p),g&&this.metricChoices(b)),r.a.createElement(na.a,{item:!0,xs:f||g?10:12,className:a.table},r.a.createElement(ee.a,{stickyHeader:!0},r.a.createElement(te.a,null,r.a.createElement(ae.a,null,this.sortedCell("trial_id"),this.sortedCell("job_id"),this.sortedCell("start_time"),d.map((function(t,a){return e.sortedCell("params",t,a)})),this.sortedCell("status"),h.map((function(t,a){return e.sortedCell("metrics",t,a)})),r.a.createElement(ne.a,{className:a.cell,key:"error"},"Error"))),r.a.createElement(re.a,null,null!==v&&v.map((function(t,n){return r.a.createElement(ae.a,{key:n},r.a.createElement(ne.a,{className:a.cell},t.trial_id),r.a.createElement(ne.a,{className:a.cell},t.job_id),r.a.createElement(ne.a,{className:a.cell},t.start_time),d.map((function(e,n){return r.a.createElement(ne.a,{className:a.cell,key:n},"number"===typeof t.params[e]?Xe(Number(t.params[e])):t.params[e])})),r.a.createElement(ne.a,{className:a.cell},t.status),t.metrics&&h.map((function(e,n){return r.a.createElement(ne.a,{className:a.cell,key:n},"number"===typeof t.metrics[e]?Xe(Number(t.metrics[e])):t.metrics[e])})),r.a.createElement(ne.a,{className:a.cell},"No Error"===t.error?"No Error":r.a.createElement(qt.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t.trial_id)}},"Show Error")))})))))),i&&r.a.createElement(Me,{handleClose:this.handleClose,title:"Error Log"},i&&r.a.createElement(Re,{lines:n.trial_records[s].error.trim().split("\n")})))}}]),a}(r.a.Component),la=Object(p.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),ra)(Object(k.a)((function(e){return Object(y.a)({root:{padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(2)}},table:{marginTop:e.spacing(1),height:"700px",overflowY:"auto"},cell:{padding:e.spacing(1),textAlign:"right","&:last-child":{paddingRight:e.spacing(1)}},checkboxRoot:{height:"500px",overflowY:"auto",overflowX:"auto"},paramChecklist:{marginBottom:e.spacing(2)}})}))(oa)),ca=me,ia=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={tensorBoardEnabled:!1,loading:!1},e.handleSubmit=function(){e.setState({loading:!0}),P().then((function(){e.setState({loading:!1})}))},e.tensorBoard=function(){var t=e.props,a=t.classes,n=t.error,o=t.tuneInfo;return r.a.createElement("div",null,"TypeError: Failed to fetch"===n&&r.a.createElement(E.a,{className:a.warning,color:"textSecondary"},'Warning: Tensorboard server closed. View Tensorboard by running "tensorboard --logdir" if not displaying below.'),o&&!o.tensorboard.tensorboard_current&&r.a.createElement(E.a,{className:a.warning,color:"textSecondary"},"The below Tensorboard reflects a previously entered log directory. Restart the Ray Dashboard to change the Tensorboard logdir."),r.a.createElement("iframe",{src:"http://localhost:6006/",className:a.board,title:"TensorBoard"}))},e}return Object(i.a)(a,[{key:"enableTensorBoard",value:function(){P(),this.setState({tensorBoardEnabled:!0})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.tuneInfo,n=this.state.loading;if(null!==a){var o=a.tensorboard.tensorboard_enabled;return r.a.createElement("div",{className:t.root},!o&&r.a.createElement("div",null,r.a.createElement(Z.a,{variant:"outlined",onClick:this.handleSubmit,className:t.warning},"Enable TensorBoard"),n&&r.a.createElement(Jt.a,{className:t.progress,size:25})),o&&this.tensorBoard())}}}]),a}(r.a.Component),sa=Object(p.b)((function(e){return{error:e.dashboard.error,tuneInfo:e.dashboard.tuneInfo}}),ca)(Object(k.a)((function(e){return Object(y.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)}},board:{width:"100%",height:"1000px",border:"none"},warning:{fontSize:"0.8125rem"},progress:{marginLeft:"10px",marginTop:"2px"}})}))(ia)),ua=me,ma=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).timeout=0,e.state={tabIndex:0,experiment:"",loading:!1},e.refreshTuneInfo=Object(v.a)(h.a.mark((function t(){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.props.tuneAvailability||!e.props.tuneAvailability.available){t.next=6;break}return t.next=4,D();case 4:a=t.sent,e.props.setTuneInfo(a);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.props.setError(t.t0.toString());case 11:return t.prev=11,e.timeout=window.setTimeout(e.refreshTuneInfo,1e3),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])}))),e.handleTabChange=function(t,a){e.setState({tabIndex:a})},e.handleExperimentChange=function(t){e.setState({experiment:t.target.value})},e.handleExperimentSubmit=Object(v.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.prev=1,t.next=4,W(e.state.experiment);case 4:return window.clearTimeout(e.timeout),t.next=7,e.refreshTuneInfo();case 7:e.setState({loading:!1}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.props.setError(t.t0.toString()),e.setState({loading:!1});case 14:case"end":return t.stop()}}),t,null,[[1,10]])}))),e.experimentChoice=function(t){var a=e.props.classes,n=e.state.loading;return r.a.createElement("div",null,t&&r.a.createElement(E.a,{className:a.heading,color:"textPrimary"},"You can use this tab to monitor Tune jobs, their statuses, hyperparameters, and more. For more information, read the documentation"," ",r.a.createElement("a",{href:"https://docs.ray.io/en/latest/ray-dashboard.html#tune"},"here"),"."),r.a.createElement("div",null,r.a.createElement(E.a,{className:a.prompt,color:"textSecondary"},"Enter Tune Log Directory Here:"),r.a.createElement(Vt.a,{className:a.input,id:"standard-basic",value:e.state.experiment,onChange:e.handleExperimentChange}),r.a.createElement(Z.a,{className:a.submit,variant:"outlined",onClick:e.handleExperimentSubmit},"Submit"),n&&r.a.createElement(Jt.a,{className:a.progress,size:25})))},e}return Object(i.a)(a,[{key:"componentWillUnmount",value:function(){var e=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.clearTimeout(this.timeout);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.tuneInfo,n=e.tuneAvailability;if(n&&!n.trials_available)return this.experimentChoice(!0);var o=this.state.tabIndex,l=[{label:"Table",component:la},{label:"TensorBoard",component:sa}];null!==a&&Object.keys(a.errors).length>0&&l.push({label:"Errors",component:Xt});var c=l[o].component;return r.a.createElement("div",{className:t.root},this.experimentChoice(!1),r.a.createElement(O.a,{className:t.tabs,indicatorColor:"primary",onChange:this.handleTabChange,textColor:"primary",value:o},l.map((function(e){var t=e.label;return r.a.createElement(j.a,{key:t,label:t})}))),r.a.createElement(c,null))}}]),a}(r.a.Component),pa=Object(p.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo,tuneAvailability:e.dashboard.tuneAvailability}}),ua)(Object(k.a)((function(e){return Object(y.a)({root:{backgroundColor:e.palette.background.paper},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1},heading:{fontsize:"0.9em",marginTop:e.spacing(2)},warning:{fontSize:"1em"},warningIcon:{fontSize:"1.25em",verticalAlign:"text-bottom"},formControl:{margin:e.spacing(1),minWidth:120},submit:{marginLeft:e.spacing(2),fontSize:"0.8125em"},prompt:{fontSize:"1em",marginTop:e.spacing(1)},input:{width:"85%"},progress:{marginLeft:e.spacing(2)}})}))(ma)),da=me,fa=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).timeoutId=0,e.tabs=[{label:"Machine view",component:zt},{label:"Logical view",component:$},{label:"Memory",component:Ce},{label:"Ray config",component:Gt},{label:"Tune",component:pa}],e.refreshInfo=Object(v.a)(h.a.mark((function t(){var a,n,r,o,l,c,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.shouldObtainMemoryTable,t.prev=1,t.next=4,Promise.all([w(),T(),B(a),R()]);case 4:n=t.sent,r=Object(g.a)(n,4),o=r[0],l=r[1],c=r[2],i=r[3],e.props.setNodeAndRayletInfo({nodeInfo:o,rayletInfo:l}),e.props.setTuneAvailability(i),e.props.setError(null),a&&e.props.setMemoryTable(c),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),e.props.setError(t.t0.toString());case 19:return t.prev=19,e.timeoutId=window.setTimeout(e.refreshInfo,1e3),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[1,16,19,22]])}))),e.handleTabChange=function(){var t=Object(v.a)(h.a.mark((function t(a,n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.props.setTab(n),"Memory"!==e.tabs[n].label){t.next=5;break}e.props.setShouldObtainMemoryTable(!0),t.next=8;break;case 5:return e.props.setShouldObtainMemoryTable(!1),t.next=8,z();case 8:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshInfo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.tab,n=e.tuneAvailability,o=this.tabs.slice();null!==n&&n.available||o.splice(4);var l=o[a].component;return r.a.createElement("div",{className:t.root},r.a.createElement(E.a,{variant:"h5"},"Ray Dashboard"),r.a.createElement(O.a,{className:t.tabs,indicatorColor:"primary",onChange:this.handleTabChange,textColor:"primary",value:a},o.map((function(e){var t=e.label;return r.a.createElement(j.a,{key:t,label:t})}))),r.a.createElement(l,null),r.a.createElement(H,null))}}]),a}(r.a.Component),ba=Object(p.b)((function(e){return{tab:e.dashboard.tab,tuneAvailability:e.dashboard.tuneAvailability,shouldObtainMemoryTable:e.dashboard.shouldObtainMemoryTable}}),da)(Object(k.a)((function(e){return Object(y.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)}},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1}})}))(fa)),ha=Object(se.a)({reducer:{dashboard:pe},devTools:!1}),ga=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(p.a,{store:ha},r.a.createElement(d.a,null,r.a.createElement(m.a,null),r.a.createElement(f.a,{component:ba,exact:!0,path:"/"})))}}]),a}(r.a.Component);l.a.render(r.a.createElement(ga,null),document.getElementById("root"))}},[[102,1,2]]]);
//# sourceMappingURL=main.d20f493a.chunk.js.map